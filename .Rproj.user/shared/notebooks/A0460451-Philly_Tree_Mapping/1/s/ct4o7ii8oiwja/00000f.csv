"0",""
"0","tree_summary <- function(url,tracts,field_name){"
"0","  tree_inv <- st_read(url) %>% "
"0","  st_transform('EPSG:2272') %>%"
"0","  st_join(.,tracts %>% select('GEOID','geometry'),join = st_intersects) %>%"
"0","  st_drop_geometry() %>%"
"0","  group_by(GEOID) %>% summarise(!!field_name := n())"
"0","  return(tree_inv)"
"0","}"
"0",""
"0","url_2023 <- 'https://opendata.arcgis.com/api/v3/datasets/bde5dd63e2464c3c94797f83c3076374_0/downloads/data?format=geojson&spatialRefId=4326&where=1%3D1'"
"0","url_2021 <- 'https://opendata.arcgis.com/api/v3/datasets/30ef36e9e880468fa74e2d5b18da4cfb_0/downloads/data?format=geojson&spatialRefId=4326'"
"0",""
"0","tree_count_2023 <- tree_summary(url_2023,Philly_Tracts,'street_tree_2023')"
"1","Reading layer `"
"1","ppr_tree_inventory_2023"
"1","' from data source "
"1","
"
"1","  "
"1","`"
"1","https://opendata.arcgis.com/api/v3/datasets/bde5dd63e2464c3c94797f83c3076374_0/downloads/data?format=geojson&spatialRefId=4326&where=1%3D1"
"1","' "
"1","
"
"1","  "
"1","using driver `"
"1","GeoJSON"
"1","'"
"1","
"
"1","Simple feature collection with 151607 features and 6 fields"
"1","
"
"1","Geometry type: POINT
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: -75.28272 ymin: 39.87498 xmax: -74.95878 ymax: 40.13746"
"1","
"
"1","Geodetic CRS:  WGS 84
"
"0","tree_count_2021 <- tree_summary(url_2021,Philly_Tracts,'street_tree_2021')"
"1","Reading layer `"
"1","PPR_Tree_Inventory_2021"
"1","' from data source "
"1","
"
"1","  "
"1","`"
"1","https://opendata.arcgis.com/api/v3/datasets/30ef36e9e880468fa74e2d5b18da4cfb_0/downloads/data?format=geojson&spatialRefId=4326"
"1","' "
"1","
"
"1","  "
"1","using driver `"
"1","GeoJSON"
"1","'"
"1","
"
"1","Simple feature collection with 152453 features and 6 fields"
"1","
"
"1","Geometry type: POINT
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: -75.28272 ymin: 39.87498 xmax: -74.95878 ymax: 40.13746"
"1","
"
"1","Geodetic CRS:  WGS 84
"
"0","Philly_Tracts <- tree_count_2021 %>%"
"0","  full_join(.,tree_count_2023,by='GEOID') %>%"
"0","  left_join(Philly_Tracts,.,by='GEOID') %>%"
"0","  mutate(street_tree_2021 = ifelse(is.na(street_tree_2021),0,street_tree_2021),"
"0","         street_tree_2023 = ifelse(is.na(street_tree_2023),0,street_tree_2023),"
"0","         tree_change = street_tree_2023 - street_tree_2021,"
"0","         pct_change = tree_change / street_tree_2021 * 100,"
"0","         pct_change = ifelse(is.nan(pct_change),0,pct_change))"
